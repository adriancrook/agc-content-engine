<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kit Mission Control</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #e4e4e7;
      min-height: 100vh;
      padding: 20px;
    }
    
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 16px;
      backdrop-filter: blur(10px);
    }
    
    .agent-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .avatar {
      width: 60px;
      height: 60px;
      background: linear-gradient(135deg, #ff6b35, #f7931e);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
    }
    
    .agent-name {
      font-size: 24px;
      font-weight: 700;
    }
    
    .status {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 4px;
      font-size: 14px;
      color: #a1a1aa;
    }
    
    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #22c55e;
      box-shadow: 0 0 10px #22c55e;
    }
    
    .status-dot.idle { background: #eab308; box-shadow: 0 0 10px #eab308; }
    .status-dot.offline { background: #ef4444; box-shadow: 0 0 10px #ef4444; }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 20px;
    }
    
    .weather-widget {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 16px;
      background: rgba(96, 165, 250, 0.1);
      border-radius: 12px;
      border: 1px solid rgba(96, 165, 250, 0.2);
    }
    
    .weather-icon {
      font-size: 32px;
      line-height: 1;
    }
    
    .weather-main {
      text-align: center;
    }
    
    .weather-temp {
      font-size: 24px;
      font-weight: 700;
      color: #e4e4e7;
    }
    
    .weather-desc {
      font-size: 11px;
      color: #a1a1aa;
      margin-top: 2px;
    }
    
    .weather-details {
      display: flex;
      flex-direction: column;
      gap: 2px;
      font-size: 11px;
      color: #71717a;
    }
    
    .weather-detail {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .weather-detail-icon {
      font-size: 12px;
    }
    
    @media (max-width: 900px) {
      .weather-widget { display: none; }
    }
    
    .sync-info {
      text-align: right;
      font-size: 13px;
      color: #71717a;
    }
    
    .notion-link {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-top: 8px;
      padding: 6px 12px;
      background: rgba(255,255,255,0.1);
      border-radius: 6px;
      color: #60a5fa;
      text-decoration: none;
      font-size: 12px;
      transition: background 0.2s;
    }
    
    .notion-link:hover {
      background: rgba(255,255,255,0.15);
    }
    
    .board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }
    
    @media (max-width: 1200px) { .board { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 700px) { .board { grid-template-columns: 1fr; } }
    
    .column {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.08);
      max-height: 500px;
      overflow-y: auto;
    }
    
    .column-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      font-weight: 600;
    }
    
    .column-header .left {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .column-header .count {
      background: rgba(255,255,255,0.1);
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 12px;
      color: #a1a1aa;
    }
    
    .column-header .icon { font-size: 16px; }
    .column.todo .column-header { color: #f472b6; }
    .column.in-progress .column-header { color: #fbbf24; }
    .column.done .column-header { color: #4ade80; }
    .column.archived .column-header { color: #a1a1aa; }
    
    .task {
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 10px;
      border-left: 3px solid transparent;
      transition: transform 0.2s, background 0.2s;
      cursor: pointer;
      text-decoration: none;
      display: block;
      color: inherit;
    }
    
    .task:hover {
      background: rgba(255,255,255,0.08);
      transform: translateX(3px);
    }
    
    .column.todo .task { border-left-color: #f472b6; }
    .column.in-progress .task { border-left-color: #fbbf24; }
    .column.done .task { border-left-color: #4ade80; }
    .column.archived .task { border-left-color: #71717a; opacity: 0.7; }
    
    .task-header {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }
    
    .priority-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      margin-top: 5px;
      flex-shrink: 0;
    }
    
    .priority-dot.urgent { background: #ef4444; box-shadow: 0 0 6px #ef4444; }
    .priority-dot.important { background: #eab308; box-shadow: 0 0 6px #eab308; }
    .priority-dot.waiting { background: #6b7280; }
    
    .task-content { flex: 1; }
    .task-title { font-size: 14px; margin-bottom: 5px; line-height: 1.3; }
    
    .task-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      align-items: center;
      margin-top: 6px;
    }
    
    .task-date { font-size: 11px; color: #71717a; }
    
    .task-category {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 500;
    }
    
    .category-dreamdrop { background: rgba(251, 146, 60, 0.2); color: #fb923c; }
    .category-aca { background: rgba(244, 114, 182, 0.2); color: #f472b6; }
    .category-teaching { background: rgba(168, 85, 247, 0.2); color: #a855f7; }
    .category-basecamp { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
    .category-other { background: rgba(156, 163, 175, 0.2); color: #9ca3af; }
    
    .task-notes {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 4px;
      font-style: italic;
    }
    
    .bottom-grid {
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 20px;
    }
    
    @media (max-width: 1600px) { .bottom-grid { grid-template-columns: repeat(3, 1fr); } }
    @media (max-width: 900px) { .bottom-grid { grid-template-columns: 1fr 1fr; } }
    @media (max-width: 600px) { .bottom-grid { grid-template-columns: 1fr; } }
    
    .panel {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    
    .panel-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
      font-weight: 600;
      font-size: 14px;
      color: #a1a1aa;
    }
    
    .job-item, .log-item, .note-item {
      padding: 10px;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      margin-bottom: 8px;
      font-size: 13px;
    }
    
    .job-name { font-weight: 600; color: #60a5fa; }
    .job-schedule { font-size: 11px; color: #71717a; margin-top: 3px; }
    .job-desc { font-size: 12px; color: #a1a1aa; margin-top: 3px; }
    
    .log-time { font-size: 11px; color: #71717a; margin-bottom: 3px; }
    .log-action { color: #e4e4e7; }
    
    .note-item {
      border-left: 3px solid #8b5cf6;
      padding-left: 12px;
    }
    
    .empty-state {
      color: #6b7280;
      font-size: 13px;
      text-align: center;
      padding: 20px;
    }
    
    /* Communication Hub */
    .comm-item {
      padding: 12px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 10px;
      border-left: 3px solid #60a5fa;
    }
    
    .comm-item.has-unread {
      border-left-color: #f472b6;
      background: rgba(244, 114, 182, 0.08);
    }
    
    .comm-item.error {
      border-left-color: #ef4444;
      opacity: 0.7;
    }
    
    .comm-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }
    
    .comm-account {
      font-weight: 600;
      font-size: 13px;
      color: #e4e4e7;
    }
    
    .comm-badge {
      background: #f472b6;
      color: white;
      font-size: 11px;
      font-weight: 700;
      padding: 2px 8px;
      border-radius: 10px;
      min-width: 22px;
      text-align: center;
    }
    
    .comm-badge.zero {
      background: rgba(255,255,255,0.1);
      color: #71717a;
    }
    
    .comm-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: #71717a;
    }
    
    .comm-status {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .comm-status-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #22c55e;
    }
    
    .comm-status-dot.stale { background: #eab308; }
    .comm-status-dot.error { background: #ef4444; }
    .comm-status-dot.unknown { background: #6b7280; }
    
    .check-btn {
      background: rgba(96, 165, 250, 0.2);
      border: none;
      color: #60a5fa;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 11px;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .check-btn:hover {
      background: rgba(96, 165, 250, 0.3);
    }
    
    .check-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .comm-notes {
      margin-top: 12px;
      padding: 10px;
      background: rgba(139, 92, 246, 0.1);
      border-radius: 6px;
      font-size: 11px;
      color: #a1a1aa;
      border-left: 2px solid #8b5cf6;
    }
    
    /* Calendar Widget */
    .calendar-section {
      margin-bottom: 20px;
    }
    
    .calendar-panel {
      background: rgba(255,255,255,0.03);
      border-radius: 12px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.08);
    }
    
    .calendar-panel .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      font-weight: 600;
      font-size: 14px;
      color: #60a5fa;
    }
    
    .calendar-link {
      font-size: 12px;
      color: #71717a;
      text-decoration: none;
      transition: color 0.2s;
    }
    
    .calendar-link:hover { color: #60a5fa; }
    
    .calendar-days {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
    }
    
    @media (max-width: 900px) { .calendar-days { grid-template-columns: repeat(2, 1fr); } }
    @media (max-width: 500px) { .calendar-days { grid-template-columns: 1fr; } }
    
    .calendar-day {
      background: rgba(255,255,255,0.02);
      border-radius: 8px;
      padding: 12px;
      min-height: 120px;
    }
    
    .calendar-day:first-child {
      background: rgba(96, 165, 250, 0.08);
      border: 1px solid rgba(96, 165, 250, 0.2);
    }
    
    .day-header {
      font-weight: 600;
      font-size: 13px;
      color: #a1a1aa;
      margin-bottom: 10px;
      padding-bottom: 6px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    
    .calendar-day:first-child .day-header {
      color: #60a5fa;
    }
    
    .day-events {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .calendar-event {
      background: rgba(255,255,255,0.05);
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 12px;
      border-left: 3px solid #60a5fa;
      transition: background 0.2s, transform 0.2s;
      text-decoration: none;
      color: inherit;
      display: block;
    }
    
    .calendar-event:hover {
      background: rgba(255,255,255,0.08);
      transform: translateX(2px);
    }
    
    .calendar-event.soon {
      border-left-color: #f59e0b;
      background: rgba(245, 158, 11, 0.1);
    }
    
    .calendar-event.now {
      border-left-color: #22c55e;
      background: rgba(34, 197, 94, 0.1);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    
    .calendar-event.all-day {
      border-left-color: #8b5cf6;
    }
    
    .event-time {
      font-size: 10px;
      color: #71717a;
      margin-bottom: 3px;
    }
    
    .event-time.soon { color: #f59e0b; font-weight: 600; }
    .event-time.now { color: #22c55e; font-weight: 600; }
    
    .event-title {
      font-weight: 500;
      color: #e4e4e7;
      line-height: 1.3;
    }
    
    .event-location {
      font-size: 10px;
      color: #6b7280;
      margin-top: 3px;
    }
    
    .calendar-status {
      margin-top: 10px;
      font-size: 11px;
      color: #6b7280;
      text-align: center;
    }
    
    .calendar-status.disconnected {
      color: #f59e0b;
    }
    
    /* Quick Actions */
    .action-btn {
      display: flex;
      align-items: center;
      gap: 10px;
      width: 100%;
      padding: 12px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      color: #e4e4e7;
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
      margin-bottom: 8px;
      position: relative;
    }
    
    .action-btn:hover {
      background: rgba(96, 165, 250, 0.15);
      border-color: rgba(96, 165, 250, 0.3);
      transform: translateX(3px);
    }
    
    .action-btn:active {
      transform: scale(0.98);
    }
    
    .action-btn.clicked {
      background: rgba(34, 197, 94, 0.2);
      border-color: rgba(34, 197, 94, 0.4);
    }
    
    .action-icon {
      font-size: 18px;
      flex-shrink: 0;
    }
    
    .action-content {
      flex: 1;
      min-width: 0;
    }
    
    .action-name {
      font-weight: 600;
      font-size: 13px;
      color: #e4e4e7;
    }
    
    .action-desc {
      font-size: 11px;
      color: #71717a;
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .action-shortcut {
      background: rgba(255,255,255,0.1);
      padding: 3px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-family: monospace;
      color: #a1a1aa;
      flex-shrink: 0;
    }
    
    .action-feedback {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 11px;
      color: #22c55e;
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .action-btn.clicked .action-feedback {
      opacity: 1;
    }
    
    .action-btn.clicked .action-shortcut {
      opacity: 0;
    }
    
    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: rgba(34, 197, 94, 0.95);
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      transition: transform 0.3s ease-out;
      z-index: 1000;
    }
    
    .toast.show {
      transform: translateX(-50%) translateY(0);
    }
    
    .toast.error {
      background: rgba(239, 68, 68, 0.95);
    }
    
    .actions-help {
      font-size: 11px;
      color: #6b7280;
      text-align: center;
      padding: 10px;
      border-top: 1px solid rgba(255,255,255,0.05);
      margin-top: 10px;
    }
    
    .actions-help kbd {
      background: rgba(255,255,255,0.1);
      padding: 2px 6px;
      border-radius: 3px;
      font-family: monospace;
      margin: 0 2px;
    }
    
    /* Loading states */
    .loading {
      position: relative;
      overflow: hidden;
    }
    
    .loading::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(
        90deg,
        transparent 0%,
        rgba(255,255,255,0.05) 50%,
        transparent 100%
      );
      animation: shimmer 1.5s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .skeleton {
      background: rgba(255,255,255,0.05);
      border-radius: 4px;
      animation: pulse 2s ease-in-out infinite;
    }
    
    .skeleton-text {
      height: 14px;
      margin-bottom: 8px;
      width: 80%;
    }
    
    .skeleton-text.short { width: 40%; }
    .skeleton-text.medium { width: 60%; }
    
    /* Last updated indicator */
    .last-updated {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      font-size: 11px;
      color: #6b7280;
      padding: 8px;
      margin-top: 20px;
    }
    
    .last-updated.stale {
      color: #eab308;
    }
    
    .refresh-indicator {
      display: inline-block;
      width: 8px;
      height: 8px;
      border: 2px solid currentColor;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      opacity: 0;
      transition: opacity 0.2s;
    }
    
    .refreshing .refresh-indicator {
      opacity: 1;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    /* Client Payments */
    .payment-item {
      padding: 12px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 10px;
      border-left: 3px solid #22c55e;
      transition: transform 0.2s, background 0.2s;
    }
    
    .payment-item:hover {
      background: rgba(255,255,255,0.05);
      transform: translateX(2px);
    }
    
    .payment-item.pending {
      border-left-color: #eab308;
    }
    
    .payment-item.overdue {
      border-left-color: #ef4444;
      background: rgba(239, 68, 68, 0.08);
    }
    
    .payment-item.warning {
      border-left-color: #f97316;
      background: rgba(249, 115, 22, 0.05);
    }
    
    .payment-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }
    
    .payment-client {
      font-weight: 600;
      font-size: 13px;
      color: #e4e4e7;
    }
    
    .payment-amount {
      font-weight: 700;
      font-size: 14px;
      color: #22c55e;
    }
    
    .payment-item.pending .payment-amount {
      color: #eab308;
    }
    
    .payment-item.overdue .payment-amount {
      color: #ef4444;
    }
    
    .payment-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 11px;
      color: #71717a;
    }
    
    .payment-status {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .payment-status-badge {
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
      text-transform: uppercase;
    }
    
    .payment-status-badge.paid {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }
    
    .payment-status-badge.pending {
      background: rgba(234, 179, 8, 0.2);
      color: #eab308;
    }
    
    .payment-status-badge.overdue {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }
    
    .payment-due {
      font-size: 11px;
    }
    
    .payment-due.overdue {
      color: #ef4444;
      font-weight: 600;
    }
    
    .payment-due.warning {
      color: #f97316;
    }
    
    .payment-notes {
      font-size: 10px;
      color: #6b7280;
      margin-top: 4px;
      font-style: italic;
    }
    
    .payment-summary {
      margin-top: 12px;
      padding: 10px;
      background: rgba(255,255,255,0.02);
      border-radius: 6px;
      display: flex;
      justify-content: space-between;
      font-size: 11px;
      color: #a1a1aa;
    }
    
    .payment-total {
      font-weight: 700;
      color: #e4e4e7;
    }
    
    /* Sessions Monitor */
    .session-item {
      padding: 10px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 8px;
      border-left: 3px solid #60a5fa;
      transition: transform 0.2s, background 0.2s;
    }
    
    .session-item:hover {
      background: rgba(255,255,255,0.05);
      transform: translateX(2px);
    }
    
    .session-item.main {
      border-left-color: #22c55e;
      background: rgba(34, 197, 94, 0.08);
    }
    
    .session-item.cron {
      border-left-color: #8b5cf6;
    }
    
    .session-item.subagent {
      border-left-color: #f59e0b;
    }
    
    .session-item.stale {
      opacity: 0.6;
    }
    
    .session-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    
    .session-name {
      font-weight: 600;
      font-size: 12px;
      color: #e4e4e7;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .session-badge {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 4px;
      font-weight: 600;
    }
    
    .session-badge.main {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }
    
    .session-badge.cron {
      background: rgba(139, 92, 246, 0.2);
      color: #a78bfa;
    }
    
    .session-badge.subagent {
      background: rgba(245, 158, 11, 0.2);
      color: #fbbf24;
    }
    
    .session-age {
      font-size: 10px;
      color: #71717a;
    }
    
    .session-meta {
      display: flex;
      justify-content: space-between;
      font-size: 10px;
      color: #6b7280;
    }
    
    .session-tokens {
      color: #a1a1aa;
    }
    
    .session-model {
      color: #60a5fa;
    }
    
    .sessions-summary {
      margin-top: 10px;
      padding: 8px;
      background: rgba(255,255,255,0.02);
      border-radius: 6px;
      font-size: 11px;
      color: #71717a;
      text-align: center;
    }
    
    .sessions-summary .count {
      color: #60a5fa;
      font-weight: 700;
    }
    
    /* GitHub Activity Widget */
    .github-summary {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    
    .github-stat {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      font-size: 11px;
    }
    
    .github-stat-value {
      font-weight: 700;
      color: #e4e4e7;
    }
    
    .github-stat-label {
      color: #71717a;
    }
    
    .github-trend {
      font-size: 10px;
      padding: 2px 5px;
      border-radius: 3px;
    }
    
    .github-trend.up {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }
    
    .github-trend.down {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }
    
    .github-trend.neutral {
      background: rgba(113, 113, 122, 0.2);
      color: #71717a;
    }
    
    .github-section {
      margin-bottom: 12px;
    }
    
    .github-section-header {
      font-size: 11px;
      font-weight: 600;
      color: #a1a1aa;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .github-issue {
      display: block;
      padding: 8px 10px;
      background: rgba(255,255,255,0.03);
      border-radius: 6px;
      margin-bottom: 6px;
      border-left: 3px solid #60a5fa;
      text-decoration: none;
      color: inherit;
      transition: transform 0.2s, background 0.2s;
    }
    
    .github-issue:hover {
      background: rgba(255,255,255,0.06);
      transform: translateX(2px);
    }
    
    .github-issue.is-new {
      border-left-color: #f59e0b;
      background: rgba(245, 158, 11, 0.08);
    }
    
    .github-issue.is-pr {
      border-left-color: #22c55e;
    }
    
    .github-issue.is-draft {
      opacity: 0.7;
    }
    
    .github-issue-header {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }
    
    .github-issue-number {
      font-size: 10px;
      color: #60a5fa;
      font-weight: 600;
      white-space: nowrap;
    }
    
    .github-issue-title {
      font-size: 12px;
      color: #e4e4e7;
      line-height: 1.3;
      flex: 1;
    }
    
    .github-issue-meta {
      display: flex;
      gap: 8px;
      margin-top: 4px;
      font-size: 10px;
      color: #71717a;
    }
    
    .github-label {
      font-size: 9px;
      padding: 1px 4px;
      border-radius: 3px;
      background: rgba(96, 165, 250, 0.2);
      color: #60a5fa;
    }
    
    .github-new-badge {
      font-size: 9px;
      padding: 1px 4px;
      border-radius: 3px;
      background: rgba(245, 158, 11, 0.3);
      color: #fbbf24;
      font-weight: 600;
    }
    
    .github-release {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      background: rgba(139, 92, 246, 0.1);
      border-radius: 4px;
      margin-bottom: 6px;
      font-size: 11px;
    }
    
    .github-release-tag {
      font-weight: 700;
      color: #a78bfa;
    }
    
    .github-release-date {
      color: #71717a;
      font-size: 10px;
    }
    
    .github-footer {
      margin-top: 10px;
      padding-top: 8px;
      border-top: 1px solid rgba(255,255,255,0.05);
      font-size: 10px;
      color: #6b7280;
      display: flex;
      justify-content: space-between;
    }
    
    .github-link {
      color: #60a5fa;
      text-decoration: none;
    }
    
    .github-link:hover {
      text-decoration: underline;
    }
    
    #githubActivity + .empty-state,
    .github-panel .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    /* Portfolio Widget */
    .portfolio-panel { grid-column: span 2; }
    .portfolio-summary {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: rgba(255,255,255,0.03);
      border-radius: 8px;
      margin-bottom: 12px;
    }
    .portfolio-total {
      font-size: 24px;
      font-weight: 700;
      color: #e4e4e7;
    }
    .portfolio-change {
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 4px;
    }
    .portfolio-change.up { background: rgba(34,197,94,0.2); color: #4ade80; }
    .portfolio-change.down { background: rgba(239,68,68,0.2); color: #f87171; }
    .portfolio-daily {
      font-size: 12px;
      color: #a1a1aa;
      margin-top: 4px;
    }
    .portfolio-positions {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .position-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 10px;
      background: rgba(255,255,255,0.02);
      border-radius: 6px;
      font-size: 13px;
    }
    .position-row:hover { background: rgba(255,255,255,0.05); }
    .position-symbol {
      font-weight: 600;
      color: #60a5fa;
      min-width: 70px;
    }
    .position-name {
      color: #a1a1aa;
      font-size: 11px;
      flex: 1;
      margin-left: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .position-value {
      text-align: right;
      min-width: 80px;
    }
    .position-change {
      font-size: 11px;
      min-width: 60px;
      text-align: right;
    }
    .position-change.up { color: #4ade80; }
    .position-change.down { color: #f87171; }
    .position-details {
      display: flex;
      gap: 12px;
      font-size: 10px;
      color: #71717a;
      margin-top: 4px;
      padding-left: 78px;
    }
    .position-cost {
      color: #a1a1aa;
    }
    .position-divs {
      color: #fbbf24;
    }
    .position-yield {
      color: #4ade80;
      font-weight: 500;
    }
    .portfolio-footer {
      font-size: 11px;
      color: #71717a;
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
    }
    
    /* Daily Stock Pick Widget */
    .stock-pick-panel { background: linear-gradient(135deg, rgba(34,197,94,0.1) 0%, rgba(59,130,246,0.1) 100%); }
    .stock-pick-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .stock-pick-date {
      font-size: 11px;
      color: #71717a;
    }
    .stock-pick-ticker {
      font-size: 28px;
      font-weight: 700;
      color: #4ade80;
    }
    .stock-pick-name {
      font-size: 13px;
      color: #a1a1aa;
      margin-bottom: 12px;
    }
    .stock-pick-price {
      display: flex;
      gap: 20px;
      margin-bottom: 12px;
    }
    .stock-pick-stat {
      display: flex;
      flex-direction: column;
    }
    .stock-pick-stat-label {
      font-size: 10px;
      color: #71717a;
      text-transform: uppercase;
    }
    .stock-pick-stat-value {
      font-size: 16px;
      font-weight: 600;
      color: #e4e4e7;
    }
    .stock-pick-distance {
      color: #fbbf24;
    }
    .stock-pick-signal {
      font-size: 12px;
      padding: 8px 12px;
      background: rgba(0,0,0,0.2);
      border-radius: 6px;
      color: #a1a1aa;
      border-left: 3px solid #4ade80;
    }
    .stock-pick-chart {
      margin: 12px 0;
      height: 120px;
      position: relative;
    }
    .stock-pick-chart svg {
      width: 100%;
      height: 100%;
    }
    .stock-pick-link {
      display: inline-block;
      margin-top: 10px;
      padding: 6px 12px;
      background: rgba(96,165,250,0.2);
      color: #60a5fa;
      border-radius: 4px;
      text-decoration: none;
      font-size: 12px;
    }
    .stock-pick-link:hover {
      background: rgba(96,165,250,0.3);
    }
    .stock-pick-wisdom {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 14px;
      padding: 10px;
      background: rgba(0,0,0,0.3);
      border-radius: 8px;
    }
    .stock-pick-wisdom img {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      filter: grayscale(100%);
      object-fit: cover;
    }
    .stock-pick-wisdom-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #374151 0%, #1f2937 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: #9ca3af;
      flex-shrink: 0;
    }
    .stock-pick-wisdom-text {
      flex: 1;
    }
    .stock-pick-wisdom-quote {
      font-size: 11px;
      font-style: italic;
      color: #a1a1aa;
      line-height: 1.4;
    }
    .stock-pick-wisdom-author {
      font-size: 10px;
      color: #71717a;
      margin-top: 4px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="agent-info">
      <div class="avatar" id="avatar">ü¶ä</div>
      <div>
        <div class="agent-name" id="agentName">Kit Mission Control</div>
        <div class="status">
          <div class="status-dot" id="statusDot"></div>
          <span id="statusText">Loading...</span>
        </div>
      </div>
    </div>
    <div class="header-right">
      <div class="weather-widget" id="weatherWidget">
        <div class="weather-icon" id="weatherIcon">üå°Ô∏è</div>
        <div class="weather-main">
          <div class="weather-temp"><span id="weatherTemp">--</span>¬∞C</div>
          <div class="weather-desc" id="weatherDesc">Loading...</div>
        </div>
        <div class="weather-details">
          <div class="weather-detail">
            <span class="weather-detail-icon">üíß</span>
            <span id="weatherHumidity">--%</span>
          </div>
          <div class="weather-detail">
            <span class="weather-detail-icon">üí®</span>
            <span id="weatherWind">-- km/h</span>
          </div>
          <div class="weather-detail">
            <span class="weather-detail-icon">üìç</span>
            <span id="weatherLocation">Vancouver</span>
          </div>
        </div>
      </div>
      <div class="sync-info">
        <div>Last sync: <span id="lastSync">--</span></div>
        <div style="margin-top: 5px; color: #60a5fa;">‚óè Online</div>
        <a href="#" class="notion-link" id="notionLink" target="_blank">
          üìù Open in Notion
        </a>
      </div>
    </div>
  </div>
  
  <div class="board">
    <div class="column todo">
      <div class="column-header">
        <div class="left"><span class="icon">üìã</span> To Do</div>
        <span class="count" id="todoCount">0</span>
      </div>
      <div id="todoTasks"></div>
    </div>
    <div class="column in-progress">
      <div class="column-header">
        <div class="left"><span class="icon">‚ö°</span> In Progress</div>
        <span class="count" id="inProgressCount">0</span>
      </div>
      <div id="inProgressTasks"></div>
    </div>
    <div class="column done">
      <div class="column-header">
        <div class="left"><span class="icon">‚úÖ</span> Done</div>
        <span class="count" id="doneCount">0</span>
      </div>
      <div id="doneTasks"></div>
    </div>
    <div class="column archived">
      <div class="column-header">
        <div class="left"><span class="icon">üì¶</span> Later</div>
        <span class="count" id="archivedCount">0</span>
      </div>
      <div id="archivedTasks"></div>
    </div>
  </div>
  
  <div class="calendar-section">
    <div class="panel calendar-panel">
      <div class="panel-header">
        <span>üìÖ Upcoming</span>
        <a href="https://calendar.google.com" target="_blank" class="calendar-link">Open Calendar</a>
      </div>
      <div class="calendar-days" id="calendarDays">
        <div class="calendar-day">
          <div class="day-header">Today</div>
          <div class="day-events" id="day0Events"><div class="empty-state">Loading...</div></div>
        </div>
        <div class="calendar-day">
          <div class="day-header" id="day1Header">Tomorrow</div>
          <div class="day-events" id="day1Events"><div class="empty-state">Loading...</div></div>
        </div>
        <div class="calendar-day">
          <div class="day-header" id="day2Header">--</div>
          <div class="day-events" id="day2Events"><div class="empty-state">Loading...</div></div>
        </div>
        <div class="calendar-day">
          <div class="day-header" id="day3Header">--</div>
          <div class="day-events" id="day3Events"><div class="empty-state">Loading...</div></div>
        </div>
      </div>
      <div class="calendar-status" id="calendarStatus"></div>
    </div>
  </div>
  
  <div class="bottom-grid">
    <div class="panel">
      <div class="panel-header">‚ö° Quick Actions</div>
      <div id="quickActions">
        <div class="empty-state">Loading...</div>
      </div>
      <div class="actions-help">
        Press <kbd>Alt</kbd>+<kbd>1-5</kbd> for shortcuts
      </div>
    </div>
    <div class="panel">
      <div class="panel-header">üì¨ Communication Hub</div>
      <div id="commHub">
        <div class="comm-item">
          <div class="comm-header">
            <span class="comm-account">üìß kit@adriancrook.com</span>
            <span class="comm-badge zero" id="emailBadge">--</span>
          </div>
          <div class="comm-meta">
            <div class="comm-status">
              <span class="comm-status-dot unknown" id="emailDot"></span>
              <span id="emailLastCheck">Never checked</span>
            </div>
          </div>
        </div>
        <div class="comm-item">
          <div class="comm-header">
            <span class="comm-account">üì∏ @adriancrookinc</span>
            <span class="comm-badge zero" id="instaBadge">--</span>
          </div>
          <div class="comm-meta">
            <div class="comm-status">
              <span class="comm-status-dot unknown" id="instaDot"></span>
              <span id="instaLastCheck">Never checked</span>
            </div>
          </div>
        </div>
        <div class="comm-notes" id="commNotes">Communication checks happen during heartbeat polls</div>
      </div>
    </div>
    <div class="panel">
      <div class="panel-header">‚è∞ Scheduled Jobs</div>
      <div id="scheduledJobs"></div>
    </div>
    <div class="panel">
      <div class="panel-header">üìù Action Log</div>
      <div id="actionLog"></div>
    </div>
    <div class="panel">
      <div class="panel-header">üí° Notes for Kit</div>
      <div id="notes"></div>
    </div>
    <div class="panel">
      <div class="panel-header">üí∞ Client Payments</div>
      <div id="clientPayments">
        <div class="empty-state">Loading...</div>
      </div>
    </div>
    <div class="panel portfolio-panel">
      <div class="panel-header">üìà Portfolio</div>
      <div id="portfolioWidget">
        <div class="empty-state">Loading...</div>
      </div>
    </div>
    <div class="panel stock-pick-panel">
      <div class="panel-header">üéØ Daily Stock Pick</div>
      <div id="stockPickWidget">
        <div class="empty-state">Loading...</div>
      </div>
    </div>
    <div class="panel">
      <div class="panel-header">üîå Sessions</div>
      <div id="sessionsMonitor">
        <div class="empty-state">Loading...</div>
      </div>
    </div>
    <div class="panel github-panel">
      <div class="panel-header" style="display:flex;justify-content:space-between;align-items:center;">
        <span>üêô GitHub Activity</span>
        <a href="https://github.com/clawdbot/clawdbot/issues" target="_blank" class="github-link" style="font-size:11px;">View All ‚Üí</a>
      </div>
      <div id="githubActivity">
        <div class="empty-state">Loading...</div>
      </div>
    </div>
  </div>
  
  <div class="last-updated" id="lastUpdated">
    <span class="refresh-indicator"></span>
    <span>Auto-refresh in <span id="refreshCountdown">60</span>s</span>
  </div>
  
  <script>
    function getCategoryClass(category) {
      if (!category) return 'category-other';
      const cat = category.toLowerCase();
      if (cat.includes('dreamdrop')) return 'category-dreamdrop';
      if (cat.includes('ac&a') || cat.includes('aca')) return 'category-aca';
      if (cat.includes('teaching')) return 'category-teaching';
      if (cat.includes('basecamp')) return 'category-basecamp';
      return 'category-other';
    }
    
    function getPriorityClass(quadrant) {
      if (!quadrant) return '';
      if (quadrant.includes('üî¥')) return 'urgent';
      if (quadrant.includes('üü°')) return 'important';
      if (quadrant.includes('‚è≥')) return 'waiting';
      return '';
    }
    
    async function loadDashboard() {
      try {
        const res = await fetch('data.json?t=' + Date.now());
        const data = await res.json();
        
        // Agent info
        document.getElementById('avatar').textContent = data.agent.emoji;
        document.getElementById('agentName').textContent = data.agent.name + ' Mission Control';
        document.getElementById('statusText').textContent = data.agent.statusText;
        document.getElementById('statusDot').className = 'status-dot ' + (data.agent.status === 'online' ? '' : data.agent.status);
        
        // Notion link
        if (data.notionUrl) {
          document.getElementById('notionLink').href = data.notionUrl;
        }
        
        // Last sync
        const syncDate = new Date(data.lastSync);
        document.getElementById('lastSync').textContent = syncDate.toLocaleString();
        
        // Tasks with counts
        renderTasks('todoTasks', data.tasks.todo, 'todoCount');
        renderTasks('inProgressTasks', data.tasks.inProgress, 'inProgressCount');
        renderTasks('doneTasks', data.tasks.done.slice(0, 5), 'doneCount', data.tasks.done.length);
        renderTasks('archivedTasks', data.tasks.archived, 'archivedCount');
        
        // Scheduled jobs
        const jobsHtml = data.scheduledJobs.length ? data.scheduledJobs.map(job => `
          <div class="job-item">
            <div class="job-name">${escapeHtml(job.name)}</div>
            <div class="job-schedule">${escapeHtml(job.schedule)}</div>
            <div class="job-desc">${escapeHtml(job.description)}</div>
          </div>
        `).join('') : '<div class="empty-state">No scheduled jobs</div>';
        document.getElementById('scheduledJobs').innerHTML = jobsHtml;
        
        // Action log
        const logHtml = data.actionLog.length ? data.actionLog.slice(0, 6).map(log => {
          const sourceIcon = log.source === 'memory' ? 'üìù' : (log.source === 'git' ? 'üíæ' : '');
          return `
          <div class="log-item">
            <div class="log-time">${sourceIcon} ${new Date(log.time).toLocaleString()}</div>
            <div class="log-action">${escapeHtml(log.action)}</div>
          </div>
        `}).join('') : '<div class="empty-state">No recent actions</div>';
        document.getElementById('actionLog').innerHTML = logHtml;
        
        // Notes
        const notesHtml = data.notes.length ? data.notes.map(note => `
          <div class="note-item">${escapeHtml(note)}</div>
        `).join('') : '<div class="empty-state">No notes</div>';
        document.getElementById('notes').innerHTML = notesHtml;
        
      } catch (e) {
        console.error('Failed to load dashboard data:', e);
      }
    }
    
    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    function renderTasks(elementId, tasks, countId, totalCount) {
      const count = totalCount !== undefined ? totalCount : tasks.length;
      document.getElementById(countId).textContent = count;
      
      if (!tasks.length) {
        document.getElementById(elementId).innerHTML = '<div class="empty-state">No tasks</div>';
        return;
      }
      
      const html = tasks.map(task => {
        const priorityClass = getPriorityClass(task.quadrant);
        const categoryClass = getCategoryClass(task.category);
        
        return `
        <a href="${task.url || '#'}" target="_blank" class="task">
          <div class="task-header">
            ${priorityClass ? `<div class="priority-dot ${priorityClass}"></div>` : ''}
            <div class="task-content">
              <div class="task-title">${escapeHtml(task.title)}</div>
              <div class="task-meta">
                ${task.category ? `<span class="task-category ${categoryClass}">${escapeHtml(task.category)}</span>` : ''}
                ${task.date ? `<span class="task-date">${escapeHtml(task.date)}</span>` : ''}
              </div>
              ${task.notes ? `<div class="task-notes">${escapeHtml(task.notes)}</div>` : ''}
            </div>
          </div>
        </a>
      `}).join('');
      document.getElementById(elementId).innerHTML = html;
    }
    
    async function loadCommunications() {
      try {
        const res = await fetch('communications.json?t=' + Date.now());
        const comm = await res.json();
        
        // Email
        const emailUnread = comm.email?.unread || 0;
        const emailBadge = document.getElementById('emailBadge');
        emailBadge.textContent = emailUnread;
        emailBadge.className = 'comm-badge' + (emailUnread > 0 ? '' : ' zero');
        
        const emailItem = emailBadge.closest('.comm-item');
        emailItem.className = 'comm-item' + (emailUnread > 0 ? ' has-unread' : '');
        
        // Email status dot
        const emailDot = document.getElementById('emailDot');
        const emailStatus = getCommStatus(comm.email?.lastCheck);
        emailDot.className = 'comm-status-dot ' + emailStatus;
        document.getElementById('emailLastCheck').textContent = formatLastCheck(comm.email?.lastCheck, comm.email?.lastCheckHuman);
        
        // Instagram
        const instaUnread = comm.instagram?.unread || 0;
        const instaBadge = document.getElementById('instaBadge');
        instaBadge.textContent = instaUnread;
        instaBadge.className = 'comm-badge' + (instaUnread > 0 ? '' : ' zero');
        
        const instaItem = instaBadge.closest('.comm-item');
        instaItem.className = 'comm-item' + (instaUnread > 0 ? ' has-unread' : '');
        
        // Instagram status dot
        const instaDot = document.getElementById('instaDot');
        const instaStatus = getCommStatus(comm.instagram?.lastCheck);
        instaDot.className = 'comm-status-dot ' + instaStatus;
        document.getElementById('instaLastCheck').textContent = formatLastCheck(comm.instagram?.lastCheck, comm.instagram?.lastCheckHuman);
        
        // Notes
        if (comm.notes) {
          document.getElementById('commNotes').textContent = comm.notes;
        }
        
      } catch (e) {
        console.error('Failed to load communications:', e);
      }
    }
    
    function getCommStatus(timestamp) {
      if (!timestamp) return 'unknown';
      const age = Date.now() - (timestamp * 1000);
      const hours = age / (1000 * 60 * 60);
      if (hours < 2) return '';  // Fresh - green
      if (hours < 8) return 'stale';  // Yellow
      return 'error';  // Red - too old
    }
    
    function formatLastCheck(timestamp, humanStr) {
      if (!timestamp) return humanStr || 'Never checked';
      const date = new Date(timestamp * 1000);
      const now = new Date();
      const diffMs = now - date;
      const diffMins = Math.floor(diffMs / 60000);
      const diffHours = Math.floor(diffMins / 60);
      
      if (diffMins < 60) return diffMins + 'm ago';
      if (diffHours < 24) return diffHours + 'h ago';
      return date.toLocaleDateString();
    }
    
    async function loadCalendar() {
      try {
        const res = await fetch('calendar.json?t=' + Date.now());
        const cal = await res.json();
        
        const statusEl = document.getElementById('calendarStatus');
        
        if (!cal.connected) {
          // Show disconnected state
          for (let i = 0; i < 4; i++) {
            document.getElementById(`day${i}Events`).innerHTML = 
              '<div class="empty-state" style="font-size:11px;">Not connected</div>';
          }
          statusEl.textContent = cal.message || 'Calendar not connected';
          statusEl.className = 'calendar-status disconnected';
          return;
        }
        
        // Set day headers
        const today = new Date();
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        for (let i = 1; i <= 3; i++) {
          const d = new Date(today);
          d.setDate(d.getDate() + i);
          const label = i === 1 ? 'Tomorrow' : `${days[d.getDay()]}, ${months[d.getMonth()]} ${d.getDate()}`;
          document.getElementById(`day${i}Header`).textContent = label;
        }
        
        // Group events by day
        const eventsByDay = [[], [], [], []];
        const events = cal.events || [];
        
        events.forEach(event => {
          const startDate = new Date(event.start);
          const todayStart = new Date(today.getFullYear(), today.getMonth(), today.getDate());
          const dayDiff = Math.floor((startDate - todayStart) / (1000 * 60 * 60 * 24));
          
          if (dayDiff >= 0 && dayDiff < 4) {
            eventsByDay[dayDiff].push(event);
          }
        });
        
        // Render each day
        for (let dayIndex = 0; dayIndex < 4; dayIndex++) {
          const dayEvents = eventsByDay[dayIndex];
          const container = document.getElementById(`day${dayIndex}Events`);
          
          if (dayEvents.length === 0) {
            container.innerHTML = '<div class="empty-state" style="font-size:11px;">No events</div>';
            continue;
          }
          
          container.innerHTML = dayEvents.map(event => {
            let timeStr = '';
            let classes = 'calendar-event';
            let timeClass = '';
            
            if (event.allDay) {
              timeStr = 'All day';
              classes += ' all-day';
            } else {
              const start = new Date(event.start);
              timeStr = start.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });
              
              if (event.isNow) {
                classes += ' now';
                timeClass = 'now';
                timeStr = 'üî¥ Now';
              } else if (event.isSoon) {
                classes += ' soon';
                timeClass = 'soon';
                timeStr = '‚ö° ' + timeStr;
              }
            }
            
            return `
              <a href="${event.link || '#'}" target="_blank" class="${classes}">
                <div class="event-time ${timeClass}">${timeStr}</div>
                <div class="event-title">${escapeHtml(event.title)}</div>
                ${event.location ? `<div class="event-location">üìç ${escapeHtml(event.location)}</div>` : ''}
              </a>
            `;
          }).join('');
        }
        
        // Update status
        if (cal.lastUpdate) {
          const updateDate = new Date(cal.lastUpdate);
          statusEl.textContent = 'Updated ' + updateDate.toLocaleTimeString();
          statusEl.className = 'calendar-status';
        }
        
      } catch (e) {
        console.error('Failed to load calendar:', e);
        document.getElementById('calendarStatus').textContent = 'Failed to load';
        document.getElementById('calendarStatus').className = 'calendar-status disconnected';
      }
    }
    
    // Quick Actions functionality
    let actionsConfig = { actions: [], telegramBot: 'clawdbot' };
    
    async function loadActions() {
      try {
        const res = await fetch('actions.json?t=' + Date.now());
        actionsConfig = await res.json();
        renderActions();
      } catch (e) {
        console.error('Failed to load actions:', e);
        document.getElementById('quickActions').innerHTML = '<div class="empty-state">Failed to load</div>';
      }
    }
    
    function renderActions() {
      const container = document.getElementById('quickActions');
      if (!actionsConfig.actions || !actionsConfig.actions.length) {
        container.innerHTML = '<div class="empty-state">No actions configured</div>';
        return;
      }
      
      container.innerHTML = actionsConfig.actions.map((action, idx) => `
        <button class="action-btn" data-action-id="${action.id}" data-idx="${idx}">
          <span class="action-icon">${action.name.split(' ')[0]}</span>
          <div class="action-content">
            <div class="action-name">${escapeHtml(action.name.split(' ').slice(1).join(' '))}</div>
            <div class="action-desc">${escapeHtml(action.description)}</div>
          </div>
          <span class="action-shortcut">Alt+${action.shortcut}</span>
          <span class="action-feedback">‚úì Copied!</span>
        </button>
      `).join('');
      
      // Add click handlers
      container.querySelectorAll('.action-btn').forEach(btn => {
        btn.addEventListener('click', () => triggerAction(btn.dataset.actionId));
      });
    }
    
    function triggerAction(actionId) {
      const action = actionsConfig.actions.find(a => a.id === actionId);
      if (!action) return;
      
      // Build the command to send to Kit
      let command = action.command;
      if (action.cronJob) {
        command = `Run the ${action.cronJob} cron job now`;
      }
      
      // Copy to clipboard
      navigator.clipboard.writeText(command).then(() => {
        // Visual feedback
        const btn = document.querySelector(`[data-action-id="${actionId}"]`);
        if (btn) {
          btn.classList.add('clicked');
          setTimeout(() => btn.classList.remove('clicked'), 1500);
        }
        showToast(`üìã Copied: "${command}"`);
      }).catch(err => {
        // Fallback: show the command in a toast
        showToast(`Command: ${command}`, true);
      });
    }
    
    function showToast(message, isError = false) {
      // Remove existing toast
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      
      const toast = document.createElement('div');
      toast.className = 'toast' + (isError ? ' error' : '');
      toast.textContent = message;
      document.body.appendChild(toast);
      
      // Show animation
      requestAnimationFrame(() => {
        toast.classList.add('show');
      });
      
      // Auto-hide
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 300);
      }, 3000);
    }
    
    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (!e.altKey) return;
      
      const action = actionsConfig.actions.find(a => a.shortcut.toLowerCase() === e.key.toLowerCase());
      if (action) {
        e.preventDefault();
        triggerAction(action.id);
      }
    });
    
    // Weather widget
    async function loadWeather() {
      try {
        const res = await fetch('weather.json?t=' + Date.now());
        const weather = await res.json();
        
        document.getElementById('weatherIcon').textContent = weather.current.emoji;
        document.getElementById('weatherTemp').textContent = weather.current.temp;
        document.getElementById('weatherDesc').textContent = weather.current.description;
        document.getElementById('weatherHumidity').textContent = weather.current.humidity + '%';
        document.getElementById('weatherWind').textContent = weather.current.windKph + ' km/h ' + weather.current.windDir;
        document.getElementById('weatherLocation').textContent = weather.location;
        
        // Add tooltip with more details
        const widget = document.getElementById('weatherWidget');
        widget.title = `${weather.location}\n` +
          `Feels like: ${weather.current.feelsLike}¬∞C\n` +
          `Today: ${weather.today.low}¬∞-${weather.today.high}¬∞C\n` +
          `Tomorrow: ${weather.tomorrow.emoji} ${weather.tomorrow.low}¬∞-${weather.tomorrow.high}¬∞C\n` +
          `Sunrise: ${weather.today.sunrise} | Sunset: ${weather.today.sunset}`;
        
      } catch (e) {
        console.error('Failed to load weather:', e);
        document.getElementById('weatherDesc').textContent = 'Unavailable';
      }
    }
    
    // Client Payments widget
    async function loadPayments() {
      try {
        const res = await fetch('payments.json?t=' + Date.now());
        const data = await res.json();
        
        const container = document.getElementById('clientPayments');
        const clients = data.clients || [];
        
        if (!clients.length) {
          container.innerHTML = '<div class="empty-state">No invoices tracked</div>';
          return;
        }
        
        const today = new Date();
        let totalPending = 0;
        let totalOverdue = 0;
        
        const html = clients.map(client => {
          const dueDate = new Date(client.dueDate);
          const daysUntilDue = Math.ceil((dueDate - today) / (1000 * 60 * 60 * 24));
          
          let statusClass = 'paid';
          let statusText = 'Paid';
          let dueClass = '';
          let dueText = '';
          
          if (client.status === 'pending') {
            if (daysUntilDue < 0) {
              statusClass = 'overdue';
              statusText = 'Overdue';
              dueClass = 'overdue';
              dueText = Math.abs(daysUntilDue) + ' days overdue';
              totalOverdue += client.amount;
            } else if (daysUntilDue <= (data.settings?.warningDays || 7)) {
              statusClass = 'pending';
              statusText = 'Due Soon';
              dueClass = 'warning';
              dueText = daysUntilDue === 0 ? 'Due today!' : daysUntilDue + ' days left';
              totalPending += client.amount;
            } else {
              statusClass = 'pending';
              statusText = 'Pending';
              dueText = 'Due ' + dueDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
              totalPending += client.amount;
            }
          } else if (client.status === 'paid') {
            dueText = 'Paid ‚úì';
          }
          
          const currency = client.currency || data.settings?.currency || 'USD';
          const amount = new Intl.NumberFormat('en-US', { style: 'currency', currency }).format(client.amount);
          
          return `
            <div class="payment-item ${statusClass}">
              <div class="payment-header">
                <span class="payment-client">${escapeHtml(client.name)}</span>
                <span class="payment-amount">${amount}</span>
              </div>
              <div class="payment-meta">
                <div class="payment-status">
                  <span class="payment-status-badge ${statusClass}">${statusText}</span>
                </div>
                <span class="payment-due ${dueClass}">${dueText}</span>
              </div>
              ${client.notes ? `<div class="payment-notes">${escapeHtml(client.notes)}</div>` : ''}
            </div>
          `;
        }).join('');
        
        // Add summary if there are pending amounts
        const currency = data.settings?.currency || 'USD';
        let summaryHtml = '';
        if (totalPending > 0 || totalOverdue > 0) {
          const pendingFormatted = new Intl.NumberFormat('en-US', { style: 'currency', currency }).format(totalPending);
          const overdueFormatted = new Intl.NumberFormat('en-US', { style: 'currency', currency }).format(totalOverdue);
          summaryHtml = `
            <div class="payment-summary">
              <span>Pending: <span class="payment-total" style="color:#eab308">${pendingFormatted}</span></span>
              ${totalOverdue > 0 ? `<span>Overdue: <span class="payment-total" style="color:#ef4444">${overdueFormatted}</span></span>` : ''}
            </div>
          `;
        }
        
        container.innerHTML = html + summaryHtml;
        
      } catch (e) {
        console.error('Failed to load payments:', e);
        document.getElementById('clientPayments').innerHTML = '<div class="empty-state">Failed to load</div>';
      }
    }
    
    // Portfolio Widget
    async function loadPortfolio() {
      try {
        const res = await fetch('portfolio.json?t=' + Date.now());
        const data = await res.json();
        
        const container = document.getElementById('portfolioWidget');
        
        if (!data.positions || !data.positions.length) {
          container.innerHTML = '<div class="empty-state">No portfolio data</div>';
          return;
        }
        
        const totalClass = data.total_change_cad >= 0 ? 'up' : 'down';
        const dailyClass = data.daily_change_cad >= 0 ? 'up' : 'down';
        const dailySign = data.daily_change_cad >= 0 ? '+' : '';
        const totalSign = data.total_change_pct >= 0 ? '+' : '';
        
        let html = `
          <div class="portfolio-summary">
            <div>
              <div class="portfolio-total">$${data.total_value_cad.toLocaleString('en-CA', {minimumFractionDigits: 2})} CAD</div>
              <div class="portfolio-daily ${dailyClass}">Today: ${dailySign}$${data.daily_change_cad.toLocaleString('en-CA', {minimumFractionDigits: 2})}</div>
            </div>
            <div class="portfolio-change ${totalClass}">${totalSign}${data.total_change_pct.toFixed(2)}%</div>
          </div>
          <div class="portfolio-positions">
        `;
        
        for (const p of data.positions) {
          const changeClass = p.total_change >= 0 ? 'up' : 'down';
          const sign = p.total_change_pct >= 0 ? '+' : '';
          const currSymbol = p.currency === 'CAD' ? 'C$' : '$';
          
          // Format dividends - show last 4 payouts with amounts earned
          let divStr = '';
          if (p.dividends && p.dividends.length > 0) {
            divStr = p.dividends.map(d => `${d.date}: $${d.amount.toLocaleString('en-US', {minimumFractionDigits: 2})}`).join(' ¬∑ ');
          }
          
          html += `
            <div class="position-row">
              <span class="position-symbol">${escapeHtml(p.symbol)}</span>
              <span class="position-name">${escapeHtml(p.name)}</span>
              <span class="position-value">${currSymbol}${p.market_value.toLocaleString('en-US', {minimumFractionDigits: 2})}</span>
              <span class="position-change ${changeClass}">${sign}${p.total_change_pct.toFixed(1)}%</span>
            </div>
            <div class="position-details">
              <span class="position-cost">Cost: ${currSymbol}${p.cost_basis} ‚Üí ${currSymbol}${p.price}</span>
              ${p.annual_yield > 0 ? `<span class="position-yield">Yield: ${p.annual_yield}%</span>` : ''}
              ${p.total_divs_earned > 0 ? `<span class="position-divs">Recent divs: $${p.total_divs_earned.toLocaleString('en-US', {minimumFractionDigits: 2})} (${divStr})</span>` : ''}
            </div>
          `;
        }
        
        const updated = new Date(data.updated);
        html += `</div>
          <div class="portfolio-footer">
            <span>USD/CAD: ${data.usdcad}</span>
            <span>Updated: ${updated.toLocaleTimeString()}</span>
          </div>
        `;
        
        container.innerHTML = html;
      } catch (e) {
        console.error('Failed to load portfolio:', e);
        document.getElementById('portfolioWidget').innerHTML = '<div class="empty-state">Failed to load</div>';
      }
    }
    
    // Daily Stock Pick
    async function loadStockPick() {
      try {
        const res = await fetch('stock-pick.json?t=' + Date.now());
        const data = await res.json();
        
        const container = document.getElementById('stockPickWidget');
        
        if (!data.pick) {
          container.innerHTML = '<div class="empty-state">No pick today</div>';
          return;
        }
        
        const p = data.pick;
        const distClass = p.distance_pct >= 0 ? 'up' : 'down';
        const distSign = p.distance_pct >= 0 ? '+' : '';
        
        // Build chart SVG
        let chartSvg = '';
        if (p.chart_data && p.chart_data.length > 0) {
          const prices = p.chart_data.map(d => d.price);
          const ma200s = p.chart_data.map(d => d.ma_200).filter(v => v !== null);
          const allValues = [...prices, ...ma200s];
          // Use 30% padding to make MA line look flatter (more realistic)
          const dataRange = Math.max(...allValues) - Math.min(...allValues);
          const minVal = Math.min(...allValues) - dataRange * 0.3;
          const maxVal = Math.max(...allValues) + dataRange * 0.3;
          const range = maxVal - minVal;
          
          const width = 340;
          const height = 100;
          const padding = 5;
          
          // Price line points
          const pricePoints = p.chart_data.map((d, i) => {
            const x = padding + (i / (p.chart_data.length - 1)) * (width - 2 * padding);
            const y = height - padding - ((d.price - minVal) / range) * (height - 2 * padding);
            return `${x},${y}`;
          }).join(' ');
          
          // 200 MA line points
          const maPoints = p.chart_data.filter(d => d.ma_200 !== null).map((d, i, arr) => {
            const idx = p.chart_data.indexOf(d);
            const x = padding + (idx / (p.chart_data.length - 1)) * (width - 2 * padding);
            const y = height - padding - ((d.ma_200 - minVal) / range) * (height - 2 * padding);
            return `${x},${y}`;
          }).join(' ');
          
          chartSvg = `
            <svg viewBox="0 0 ${width} ${height}" preserveAspectRatio="none">
              <polyline fill="none" stroke="#f87171" stroke-width="2" stroke-dasharray="4,2" points="${maPoints}" />
              <polyline fill="none" stroke="#4ade80" stroke-width="2" points="${pricePoints}" />
              <text x="${width - 5}" y="15" fill="#f87171" font-size="10" text-anchor="end">200W MA</text>
              <text x="${width - 5}" y="28" fill="#4ade80" font-size="10" text-anchor="end">Price</text>
            </svg>
          `;
        }
        
        const yahooUrl = p.yahoo_url || `https://finance.yahoo.com/quote/${p.ticker}`;
        
        container.innerHTML = `
          <div class="stock-pick-header">
            <span class="stock-pick-ticker">${escapeHtml(p.ticker)}</span>
            <span class="stock-pick-date">${data.date}</span>
          </div>
          <div class="stock-pick-name">${escapeHtml(p.name)} ¬∑ ${escapeHtml(p.sector)}</div>
          <div class="stock-pick-chart">${chartSvg}</div>
          <div class="stock-pick-price">
            <div class="stock-pick-stat">
              <span class="stock-pick-stat-label">Price</span>
              <span class="stock-pick-stat-value">$${p.price}</span>
            </div>
            <div class="stock-pick-stat">
              <span class="stock-pick-stat-label">200-Week MA</span>
              <span class="stock-pick-stat-value">$${p.ma_200}</span>
            </div>
            <div class="stock-pick-stat">
              <span class="stock-pick-stat-label">Distance</span>
              <span class="stock-pick-stat-value stock-pick-distance">${distSign}${p.distance_pct}%</span>
            </div>
          </div>
          <div class="stock-pick-signal">${escapeHtml(data.signal)}</div>
          <a href="${yahooUrl}" target="_blank" class="stock-pick-link">üìà View on Yahoo Finance ‚Üí</a>
          <div class="stock-pick-wisdom">
            <img src="munger.jpg" alt="Charlie Munger">
            <div class="stock-pick-wisdom-text">
              <div class="stock-pick-wisdom-quote">"If all you did was buy quality stocks on the 200-week moving average, you'd beat the S&P 500 by a wide margin. The problem is, few have that discipline."</div>
              <div class="stock-pick-wisdom-author">‚Äî Charlie Munger</div>
            </div>
          </div>
        `;
      } catch (e) {
        console.error('Failed to load stock pick:', e);
        document.getElementById('stockPickWidget').innerHTML = '<div class="empty-state">No pick available</div>';
      }
    }
    
    // Sessions Monitor
    async function loadSessions() {
      try {
        const res = await fetch('sessions.json?t=' + Date.now());
        const data = await res.json();
        
        const container = document.getElementById('sessionsMonitor');
        const sessions = data.sessions || [];
        
        if (data.error) {
          container.innerHTML = `<div class="empty-state">${escapeHtml(data.error)}</div>`;
          return;
        }
        
        if (!sessions.length) {
          container.innerHTML = '<div class="empty-state">No active sessions</div>';
          return;
        }
        
        // Format age to human readable
        function formatAge(ms) {
          if (!ms) return 'just now';
          const mins = Math.floor(ms / 60000);
          if (mins < 1) return 'just now';
          if (mins < 60) return mins + 'm ago';
          const hours = Math.floor(mins / 60);
          if (hours < 24) return hours + 'h ago';
          const days = Math.floor(hours / 24);
          return days + 'd ago';
        }
        
        // Format tokens
        function formatTokens(tokens) {
          if (!tokens) return '0';
          if (tokens >= 1000000) return (tokens / 1000000).toFixed(1) + 'M';
          if (tokens >= 1000) return (tokens / 1000).toFixed(1) + 'K';
          return tokens.toString();
        }
        
        // Get session display name
        function getSessionName(session) {
          if (session.isMain) return 'üí¨ Main Chat';
          if (session.isSubagent) return 'ü§ñ Sub-agent';
          if (session.isCron) {
            // Extract cron job ID and make it shorter
            const cronId = session.key.split('cron:')[1]?.substring(0, 8) || 'job';
            return '‚è∞ Cron: ' + cronId;
          }
          return session.key.split(':').pop();
        }
        
        // Get badge type
        function getBadgeClass(session) {
          if (session.isMain) return 'main';
          if (session.isCron) return 'cron';
          if (session.isSubagent) return 'subagent';
          return '';
        }
        
        // Get item class
        function getItemClass(session) {
          let cls = 'session-item';
          if (session.isMain) cls += ' main';
          else if (session.isCron) cls += ' cron';
          else if (session.isSubagent) cls += ' subagent';
          
          // Mark stale sessions (>6 hours old)
          if (session.ageMs > 6 * 60 * 60 * 1000) cls += ' stale';
          return cls;
        }
        
        // Only show recent sessions (last 24h) and limit to 6
        const recentSessions = sessions
          .filter(s => s.ageMs < 24 * 60 * 60 * 1000)
          .slice(0, 6);
        
        const html = recentSessions.map(session => {
          const badgeClass = getBadgeClass(session);
          const badgeText = session.isMain ? 'MAIN' : (session.isCron ? 'CRON' : (session.isSubagent ? 'AGENT' : ''));
          const model = session.model?.replace('claude-', '').replace('-4-5', ' 4.5') || 'unknown';
          
          return `
            <div class="${getItemClass(session)}">
              <div class="session-header">
                <span class="session-name">
                  ${getSessionName(session)}
                  ${badgeText ? `<span class="session-badge ${badgeClass}">${badgeText}</span>` : ''}
                </span>
                <span class="session-age">${formatAge(session.ageMs)}</span>
              </div>
              <div class="session-meta">
                <span class="session-tokens">üìä ${formatTokens(session.totalTokens)} tokens</span>
                <span class="session-model">${model}</span>
              </div>
            </div>
          `;
        }).join('');
        
        // Add summary
        const mainSession = sessions.find(s => s.isMain);
        const cronCount = sessions.filter(s => s.isCron).length;
        const summaryHtml = `
          <div class="sessions-summary">
            <span class="count">${data.count}</span> total sessions | 
            ${cronCount} cron jobs active
          </div>
        `;
        
        container.innerHTML = html + summaryHtml;
        
      } catch (e) {
        console.error('Failed to load sessions:', e);
        document.getElementById('sessionsMonitor').innerHTML = '<div class="empty-state">Failed to load</div>';
      }
    }
    
    // GitHub Activity Widget
    async function loadGithub() {
      try {
        const res = await fetch('github.json?t=' + Date.now());
        const data = await res.json();
        
        const container = document.getElementById('githubActivity');
        
        if (!data || !data.issues) {
          container.innerHTML = '<div class="empty-state">No data available</div>';
          return;
        }
        
        // Format relative time
        function timeAgo(dateStr) {
          if (!dateStr) return '';
          const date = new Date(dateStr);
          const now = new Date();
          const diffMs = now - date;
          const diffMins = Math.floor(diffMs / 60000);
          if (diffMins < 1) return 'just now';
          if (diffMins < 60) return diffMins + 'm ago';
          const diffHours = Math.floor(diffMins / 60);
          if (diffHours < 24) return diffHours + 'h ago';
          const diffDays = Math.floor(diffHours / 24);
          return diffDays + 'd ago';
        }
        
        // Summary stats
        const trend = data.summary.trend;
        const trendClass = trend > 0 ? 'up' : (trend < 0 ? 'down' : 'neutral');
        const trendText = trend > 0 ? '+' + trend : (trend < 0 ? trend : '¬±0');
        
        let html = `
          <div class="github-summary">
            <div class="github-stat">
              <span class="github-stat-value">${data.summary.openIssues}</span>
              <span class="github-stat-label">open</span>
              <span class="github-trend ${trendClass}">${trendText} today</span>
            </div>
          </div>
        `;
        
        // Recent issues
        if (data.issues.length > 0) {
          html += '<div class="github-section">';
          html += '<div class="github-section-header">üìã Recent Issues</div>';
          html += data.issues.slice(0, 5).map(issue => {
            const isNew = issue.isNew;
            const labels = (issue.labels || []).slice(0, 2).map(l => 
              '<span class="github-label">' + escapeHtml(l) + '</span>'
            ).join('');
            
            return `
              <a href="${issue.url}" target="_blank" class="github-issue ${isNew ? 'is-new' : ''}">
                <div class="github-issue-header">
                  <span class="github-issue-number">#${issue.number}</span>
                  <span class="github-issue-title">${escapeHtml(issue.title)}</span>
                </div>
                <div class="github-issue-meta">
                  <span>@${issue.author}</span>
                  <span>${timeAgo(issue.createdAt)}</span>
                  ${isNew ? '<span class="github-new-badge">NEW</span>' : ''}
                  ${labels}
                </div>
              </a>
            `;
          }).join('');
          html += '</div>';
        }
        
        // Open PRs
        if (data.prs && data.prs.length > 0) {
          html += '<div class="github-section">';
          html += '<div class="github-section-header">üîÄ Open PRs</div>';
          html += data.prs.slice(0, 3).map(pr => `
            <a href="${pr.url}" target="_blank" class="github-issue is-pr ${pr.isDraft ? 'is-draft' : ''}">
              <div class="github-issue-header">
                <span class="github-issue-number">#${pr.number}</span>
                <span class="github-issue-title">${escapeHtml(pr.title)}${pr.isDraft ? ' [draft]' : ''}</span>
              </div>
              <div class="github-issue-meta">
                <span>@${pr.author}</span>
                <span>${timeAgo(pr.createdAt)}</span>
              </div>
            </a>
          `).join('');
          html += '</div>';
        }
        
        // My PRs (kit-clawd)
        if (data.myPrs && data.myPrs.length > 0) {
          html += '<div class="github-section">';
          html += '<div class="github-section-header">ü¶ä My PRs</div>';
          html += data.myPrs.slice(0, 3).map(pr => `
            <a href="${pr.url}" target="_blank" class="github-issue is-pr">
              <div class="github-issue-header">
                <span class="github-issue-number">${pr.repo}#${pr.number}</span>
                <span class="github-issue-title">${escapeHtml(pr.title)}</span>
              </div>
            </a>
          `).join('');
          html += '</div>';
        }
        
        // Recent releases
        if (data.releases && data.releases.length > 0) {
          html += '<div class="github-section">';
          html += '<div class="github-section-header">üöÄ Recent Releases</div>';
          html += data.releases.slice(0, 2).map(release => `
            <div class="github-release">
              <span class="github-release-tag">${release.tag}</span>
              <span class="github-release-date">${timeAgo(release.date)}</span>
              ${release.isPrerelease ? '<span class="github-label">pre</span>' : ''}
            </div>
          `).join('');
          html += '</div>';
        }
        
        // Footer with last commit
        if (data.lastCommit && data.lastCommit.sha !== 'unknown') {
          html += `
            <div class="github-footer">
              <span>Last: ${escapeHtml(data.lastCommit.message)}</span>
              <span>${data.lastCommit.sha}</span>
            </div>
          `;
        }
        
        container.innerHTML = html;
        
      } catch (e) {
        console.error('Failed to load GitHub data:', e);
        document.getElementById('githubActivity').innerHTML = '<div class="empty-state">Failed to load</div>';
      }
    }
    
    // Initial loads
    loadDashboard();
    loadCommunications();
    loadCalendar();
    loadActions();
    loadWeather();
    loadPayments();
    loadPortfolio();
    loadStockPick();
    loadSessions();
    loadGithub();
    
    // Refresh countdown and auto-refresh
    let countdown = 60;
    const countdownEl = document.getElementById('refreshCountdown');
    const lastUpdatedEl = document.getElementById('lastUpdated');
    
    async function refreshAll() {
      lastUpdatedEl.classList.add('refreshing');
      await Promise.all([
        loadDashboard(),
        loadCommunications(),
        loadCalendar(),
        loadPayments(),
        loadPortfolio(),
        loadStockPick(),
        loadSessions(),
        loadGithub()
      ]);
      lastUpdatedEl.classList.remove('refreshing');
      countdown = 60;
    }
    
    setInterval(() => {
      countdown--;
      countdownEl.textContent = countdown;
      if (countdown <= 0) {
        refreshAll();
      }
    }, 1000);
    
    // Refresh weather every 15 minutes
    setInterval(loadWeather, 15 * 60 * 1000);
  </script>
</body>
</html>
