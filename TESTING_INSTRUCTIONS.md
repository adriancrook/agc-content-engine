# WordPress Publishing Workflow - Testing Instructions

**Status:** Ready for End-to-End Testing
**Date:** February 10, 2026

---

## âœ… What's Been Completed

All development is complete! You now have:

1. âœ… **Internal Linking** - Automatically adds 2-5 internal links per article
2. âœ… **WordPress Formatter** - Generates SEO metadata and YAML frontmatter
3. âœ… **Export UI** - Beautiful one-click copy/download interface
4. âœ… **API Endpoints** - `/articles/{id}/wordpress` for programmatic access
5. âœ… **Database Migration** - New WordPress columns added

---

## ğŸš€ How to Test

### Prerequisites

Make sure you have your API keys ready:
- `OPENROUTER_API_KEY` - For Claude (Writer, Fact Checker, etc.)
- `BRAVE_API_KEY` - For research/search
- `GOOGLE_API_KEY` - For Gemini (image generation)

### Step 1: Start the Server

```bash
cd v2

# Set environment variables
export USE_REAL_AGENTS=true
export OPENROUTER_API_KEY=your_openrouter_key_here
export BRAVE_API_KEY=your_brave_key_here
export GOOGLE_API_KEY=your_google_key_here

# Start server
python server.py
```

You should see:
```
ğŸš€ AGC v2 Server starting...
âœ“ Database connected: sqlite:///agc_v2.db
âœ“ Agents ready: Research (Brave) + Writer (Claude Sonnet) + ... + WordPress (no API)
âœ“ State machine started (5s interval)
âœ… Server ready!
```

### Step 2: Run the Full Pipeline Test

Open a **new terminal** (keep the server running):

```bash
cd v2
python3 test_full_wordpress_workflow.py
```

This will:
1. Create a test topic
2. Create an article from the topic
3. Monitor the pipeline through all 12 states
4. Validate WordPress content generation
5. Test the export endpoint
6. Save the WordPress-ready markdown file

**Expected Duration:** 5-10 minutes (depending on API speeds)

### Step 3: View in the UI

While the test is running (or after), open your browser:

```
http://localhost:8000
```

You'll see the dashboard with your article. Once it reaches "ready" state:

1. Click on the article
2. Scroll to the top - you'll see a beautiful purple **WordPress Export** section
3. Review the quality checklist (should show âœ… for most items)
4. Click **"Copy for WordPress"** button
5. You'll see a green toast notification: "âœ… Copied to clipboard!"

---

## ğŸ¯ Test Scenarios

### Scenario 1: Manual UI Test

1. **Create Article via UI:**
   - Go to http://localhost:8000
   - Enter a topic (e.g., "Mobile Game Retention Strategies")
   - Click create
   - Click approve

2. **Monitor Progress:**
   - Watch the dashboard as states change
   - Each state should complete in 30-120 seconds

3. **Export When Ready:**
   - Open article detail page
   - See export section appear
   - Test all 3 buttons:
     - **Copy for WordPress** - Should copy to clipboard
     - **Download .md** - Should download markdown file
     - **View Metadata** - Should toggle metadata display

### Scenario 2: Automated Test

```bash
python3 test_full_wordpress_workflow.py
```

This tests the complete pipeline automatically and shows timing for each state.

### Scenario 3: API Test

```bash
# Create topic
curl -X POST http://localhost:8000/topics \
  -H "Content-Type: application/json" \
  -d '{"title": "Mobile Game Analytics Best Practices"}'

# Note the topic ID from response, then approve it
curl -X POST http://localhost:8000/topics/{TOPIC_ID}/approve

# Note the article ID, then poll for completion
curl http://localhost:8000/articles/{ARTICLE_ID}

# When state is "ready", get WordPress content
curl http://localhost:8000/articles/{ARTICLE_ID}/wordpress
```

---

## ğŸ“Š Expected Results

### Pipeline States (in order)

1. **pending** - Article created, waiting to start
2. **researching** - Brave search + Claude analyzing sources (~60-90s)
3. **writing** - Claude writing initial draft (~90-120s)
4. **enriching** - Finding citations, metrics, testimonials (~45-60s)
5. **revising** - Claude revising with enrichment (~60-90s)
6. **fact_checking** - Claude verifying claims (~30-45s)
7. **seo_optimizing** - Claude optimizing SEO (~30-45s)
8. **humanizing** - Claude making content natural (~45-60s)
9. **internal_linking** - Adding internal links (~5-10s, no API)
10. **media_generating** - Gemini creating featured image (~30-45s)
11. **wordpress_formatting** - Generating metadata (~2-5s, no API)
12. **ready** - Article complete! ğŸ‰

**Total Time:** 5-10 minutes

### Article Quality Checklist

When article is ready, you should see:

âœ… **Export Ready** - All checks passed!
âœ… **SEO Metadata** - 2 categories, 8-12 tags
âœ… **Word Count** - 2000-3000+ words
âœ… **Featured Image** - Generated by Gemini

### WordPress Content Format

The exported content should look like:

```markdown
---
title: "Mobile Game Monetization Strategies for 2025"
description: "Expert insights on mobile game monetization..."
keywords: ["monetization", "mobile gaming", "iap", ...]
categories: ["Monetization Strategy", "Player Analytics"]
tags: ["monetization", "mobile gaming", "iap", "ads", ...]
author: "Adrian Crook"
date: "2026-02-10"
featured_image: "mobile_game_monetization_2025.png"
featured_image_alt: "Illustration for article: ..."
---

# Mobile Game Monetization Strategies for 2025

Content with [internal links](https://adriancrook.com/...)...

Citations like this[[1]](https://example.com)...

> "Expert quote in blockquote"
> â€” Expert Name[[2]](https://example.com)

## Sources
[1] Source Title - URL
[2] Source Title - URL
```

---

## ğŸ› Troubleshooting

### Issue: Server won't start

**Solution:**
```bash
# Check if port 8000 is in use
lsof -i :8000

# Kill process if needed
kill -9 <PID>

# Or use a different port
# Edit server.py and change the port
```

### Issue: "No module named 'sqlalchemy'"

**Solution:**
```bash
cd v2
source venv/bin/activate  # Activate virtual environment
pip install -r requirements.txt
```

### Issue: Pipeline stuck in one state

**Possible causes:**
1. API rate limiting (wait a few minutes)
2. API key invalid (check your keys)
3. Network issue (check internet connection)

**Check logs:**
```bash
# Server will print detailed logs
# Look for ERROR messages
```

### Issue: WordPress content not generated

**Check:**
1. Article reached "ready" state?
2. Database has WordPress columns? (Run migration if needed)
3. Check article in database:
   ```bash
   sqlite3 agc_v2.db "SELECT wordpress_export_ready FROM articles_v2 WHERE id='ARTICLE_ID';"
   ```

### Issue: Export button doesn't work

**Check browser console (F12):**
- Look for JavaScript errors
- Check if `/articles/{id}/wordpress` endpoint returns 200
- Try refreshing the page

---

## ğŸ“ Validation Checklist

After running a test, verify:

- [ ] Article reaches "ready" state
- [ ] WordPress export section appears in UI
- [ ] Quality checklist shows correct status
- [ ] "Copy for WordPress" button works
- [ ] Clipboard contains full markdown with frontmatter
- [ ] Downloaded .md file is correct
- [ ] Metadata section shows all fields
- [ ] Article has 2-5 internal links
- [ ] Article has 10+ citations
- [ ] Article has featured image
- [ ] SEO metadata is complete (title, description, categories, tags)

---

## ğŸ“ What to Look For

### Good Signs âœ…

1. **Pipeline Progress:**
   - States change regularly (not stuck)
   - Each state completes in reasonable time
   - No errors in server logs

2. **Article Quality:**
   - Word count 2000+ words
   - 10+ citations with clickable links `[[n]](url)`
   - 2-5 internal links to adriancrook.com
   - Expert quotes in blockquotes
   - Key Takeaways section
   - FAQ section
   - Sources section

3. **WordPress Export:**
   - YAML frontmatter at top
   - All metadata fields present
   - Export ready = true
   - No validation issues (or minor only)

### Warning Signs âš ï¸

1. **Pipeline Issues:**
   - State stuck for >5 minutes
   - Repeated retries on same state
   - Error messages in logs

2. **Quality Issues:**
   - Word count <2000
   - Few citations (<10)
   - No internal links
   - Missing sections (FAQ, Sources, etc.)

3. **Export Issues:**
   - wordpress_export_ready = false
   - Multiple validation issues
   - Missing metadata fields

---

## ğŸ“ Output Files

### Test Output Location

```
v2/test_outputs/
â”œâ”€â”€ wordpress_export_XXXXXXXX.md   # WordPress-ready markdown
â””â”€â”€ full_pipeline_XXXXXXXX.md      # Final article content
```

### Database Location

```
v2/agc_v2.db  # SQLite database with all articles
```

### Generated Images

Images are stored in configured location (check media agent settings).

---

## ğŸ¯ Success Criteria

A successful test means:

1. âœ… Article completes pipeline (reaches "ready" state)
2. âœ… WordPress content generated (wordpress_content field populated)
3. âœ… SEO metadata complete (title, description, categories, tags)
4. âœ… Quality checks pass (or minor warnings only)
5. âœ… Export UI works (copy/download buttons functional)
6. âœ… Content is WordPress-ready (proper frontmatter + formatting)

If all 6 criteria pass, you're **ready for production!** ğŸš€

---

## ğŸš€ Next Steps After Testing

Once testing is successful:

1. **Generate Real Articles:**
   - Create topics for your actual content
   - Let pipeline run
   - Export to WordPress

2. **WordPress Setup:**
   - Install markdown parser plugin (if needed)
   - Test paste workflow
   - Verify formatting in WordPress

3. **Optimization:**
   - Monitor API costs
   - Track generation times
   - Gather user feedback

4. **Scale Up:**
   - Generate multiple articles
   - Build content calendar
   - Automate publishing workflow

---

## ğŸ“ Support

If you encounter issues:

1. **Check logs** - Server prints detailed logs
2. **Check database** - Use sqlite3 to inspect data
3. **Test individual agents** - Run unit tests
4. **Check API keys** - Verify all keys are valid

---

## ğŸ‰ Ready to Test!

You have everything you need to test the complete WordPress publishing workflow.

**Quick Start:**
```bash
# Terminal 1
cd v2
export USE_REAL_AGENTS=true
export OPENROUTER_API_KEY=xxx
export BRAVE_API_KEY=xxx
export GOOGLE_API_KEY=xxx
python server.py

# Terminal 2
cd v2
python3 test_full_wordpress_workflow.py
```

**Then visit:** http://localhost:8000

Good luck! ğŸ€

---

*Last Updated: 2026-02-10*
*Status: READY FOR TESTING*
